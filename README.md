# Traffic Density Estimation
C++ project for estimating traffic density at a crossing.

There are 3 main folders - 
1. Code - Contains all C++ files, headers and built executables.
2. Data - Contains all pre-reqiusites like video to be processed and background frames.
3. Analysis - Contains all outputs generated by various methods, and plotting scripts, along with the PDF report.

## Dependencies
* OpenCV

## Build executable
```bash
cd ./Code
make
```
This builds all executables.

## Usage
* Store the original video in the ./Data/Videos folder - eg. Data/Videos/trafficvideo.mp4.
* Change directory to ./Code and build the executables.
```bash
cd ./Code
make
```
* **Baseline**

Single-threaded dense optical flow with full resolution and no frame-skipping. 

For example, 
```bash
./baseline trafficvideo.mp4
```
runs Baseline on Data/Videos/trafficvideo.mp4. 

Frame density data and run-time are stored at ./Analysis/Outputs/baseline.txt.

* **Method 1 (Skipping frames)**

For example,
```bash
./method1 trafficvideo.mp4 2
```
runs Method 1 on Data/Videos/trafficvideo.mp4, where 2 frames are skipped. 

Frame density data and run-time are stored at ./Analysis/Outputs/Method1/.

* **Method 2 (Reducing Resolution)**

For example,
```bash
./method2 trafficvideo.mp4 853 480
```
runs Method 2 on Data/Videos/trafficvideo.mp4, where frame resolution is reduced to 853 x 480. 

Frame density data and run-time are stored at ./Analysis/Outputs/Method2/.

* **Method 3 (Spatial splitting of frames across threads)**

For example,
```bash
./method3 trafficvideo.mp4 5
```
runs Method 3 on Data/Videos/trafficvideo.mp4, each frame is split into 5 rectangles of equal area and divided across threads. 

Frame density data and run-time are stored at ./Analysis/Outputs/Method3/.

* **Method 4 (Temporal splitting of video across threads)**

For example,
```bash
./method4 trafficvideo.mp4 4
```
runs Method 4 on Data/Videos/trafficvideo.mp4, where the video is temporally split across 4 threads. 

Frame density data and run-time are stored at ./Analysis/Outputs/Method4/.

* **Method 5 (Sparse Optical Flow)**

For example,
```bash
./method1 trafficvideo.mp4
```
runs Method 5 on Data/Videos/trafficvideo.mp4, with Sparse Optical Flow. 

Frame density data and run-time are stored at ./Analysis/Outputs/Method5/sparse.txt.

* **Utility**

For example,
```bash
./utility Method1/2.txt
```
loads the data stored at ./Analysis/Outputs/Method1/2.txt (2 frames skipped) and displays the utility for Queue and Dynamic Density on the console.
## Plot
```bash
cd ./Code
```
```bash
make compare
```
will plot the utility-runtime trade-off graphs of various parameters within each method.
```bash
make plot
```
will plot the Queue Density and Dynamic Density vs Time for various paramenters within each method.

## Clean
To remove executables, use
```bash
cd ./Code
make clean
```